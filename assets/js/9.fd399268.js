(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{204:function(t,e,i){"use strict";i.r(e);i(129);var r,n,a,s=i(130),o=i(131),c=i(132),u=i(133),l=i(135),d={name:"GiftViewer",components:{GiftBox:o.default},mixins:[c.a,u.a,l.a],data:function(){return{loading:!0,encryptionKey:"",gift:{loaded:!1,visible:!1,id:0,amount:0,content:{sender:"",receiver:"",message:""},date:"",style:0}}},computed:{formattedDate:function(){return new Date(this.gift.date).toLocaleString()}},mounted:(a=Object(s.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.gift.id=this.getParam("id"),!this.gift.id){t.next=7;break}return this.currentNetwork=this.network.default,t.next=5,this.initDapp();case 5:t.next=8;break;case 7:this.loading=!1;case 8:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)}),methods:{initDapp:(n=Object(s.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.network.current=this.network.list[this.currentNetwork],t.prev=1,t.next=4,this.initWeb3(this.currentNetwork,!0);case 4:this.initContracts(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(1),alert(t.t0),document.location.href=this.$withBase("/");case 11:case"end":return t.stop()}}),t,this,[[1,7]])}))),function(){return n.apply(this,arguments)}),ready:function(){this.getTokenVisibility()},getTokenVisibility:(r=Object(s.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.promisify(this.instances.token.isVisible,this.gift.id);case 3:e=t.sent,this.gift.visible=e[0],this.gift.visible||(this.gift.date=1e3*e[1].valueOf()),this.loading=!1,t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),this.loading=!1,alert("Some error occurred.");case 13:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return r.apply(this,arguments)}),getToken:function(){var t=this;this.$validator.validateAll().then(function(){var e=Object(s.a)(regeneratorRuntime.mark((function e(i){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=13;break}return t.loading=!0,e.prev=2,e.next=5,t.promisify(t.instances.token.getGift,t.gift.id);case 5:r=e.sent,t.formatStructure(r),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),t.loading=!1,alert("Some error occurred. Check your Encryption Key");case 13:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t){return e.apply(this,arguments)}}())},formatStructure:function(t){try{this.gift.amount=parseFloat(this.web3.fromWei(t[0])),this.gift.purchaser=t[1],this.gift.beneficiary=t[2],this.gift.content=JSON.parse(JSON.parse(this.web3.toAscii(this.decrypt(t[3],this.encryptionKey)))),this.gift.date=1e3*t[4].valueOf(),this.gift.style=t[5],this.gift.visible=!0,this.gift.loaded=!0,this.loading=!1}catch(t){this.loading=!1,alert("Some error occurred. Check your Encryption Key")}}}},f=i(5),p=Object(f.a)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-row",[i("b-col",{attrs:{lg:"8","offset-lg":"2"}},[t.loading?i("b-alert",{attrs:{show:"",variant:"light"}},[i("h4",{staticClass:"alert-heading"},[t._v("Retrieving CryptoGift. Do not refresh the page.")]),t._v(" "),i("ui--loader",{attrs:{loading:!0}})],1):t.gift.id?i("div",[t.gift.visible?[t.gift.loaded?[i("gift-box",{attrs:{gift:t.gift,network:t.network.current}})]:[i("b-card",{staticClass:"shadow border-0 rounded-0",attrs:{"no-body":""}},[i("b-card-body",[i("b-form",{on:{submit:function(e){return e.preventDefault(),t.getToken(e)}}},[i("b-form-group",{attrs:{id:"gift-encryption-key-group",label:"Encryption Key:","label-for":"gift-encryption-key",description:"Insert the Encryption Key"}},[i("b-form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"is-invalid":t.errors.has("gift-encryption-key")},attrs:{id:"gift-encryption-key",name:"gift-encryption-key",type:"password"},model:{value:t.encryptionKey,callback:function(e){t.encryptionKey=e},expression:"encryptionKey"}})],1),t._v(" "),i("b-button",{attrs:{type:"submit",variant:"outline-success",size:"lg"}},[t._v("Decrypt your CryptoGift")])],1)],1)],1)]]:[i("b-card",{staticClass:"shadow border-0 rounded-0",attrs:{"no-body":""}},[i("b-card-body",[t.gift.date?i("p",{staticClass:"card-text"},[t._v("CryptoGift will be visible on "+t._s(t.formattedDate))]):i("p",{staticClass:"card-text"},[t._v("Gift doesn't exist")])])],1)]],2):i("div",[i("b-alert",{attrs:{show:"",variant:"warning"}},[t._v("\n                No CryptoGift ID provided\n            ")]),t._v(" "),i("b-jumbotron",[i("template",{slot:"header"},[i("b-img",{attrs:{slot:"aside",src:t.$withBase("/assets/images/logo-color.png"),width:"100",alt:t.$site.title},slot:"aside"}),t._v(" "+t._s(t.$site.title)+"\n                ")],1),t._v(" "),i("template",{slot:"lead"},[t._v("\n                    "+t._s(t.$site.description)+"\n                ")]),t._v(" "),i("b-button",{attrs:{variant:"outline-success",to:"/send.html",size:"lg"}},[t._v("Create your CryptoGift")])],2)],1)],1)],1)}),[],!1,null,null,null);e.default=p.exports}}]);